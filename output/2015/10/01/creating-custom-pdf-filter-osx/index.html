<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Quernus, Matt Hamilton. An Internet technologist, interested in Python web development, iOS deployment and testing, wearables, networking and operating systems.">


        <title>Creating Custom PDF Filter on OS X // Quernus // Matt Hamilton. An Internet technologist, interested in Python web development, iOS deployment and testing, wearables, networking and operating systems.</title>

    <link href="/theme/favicon.ico" rel="icon">

    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.3.0/pure-min.css">
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Great+Vibes">  
    <link rel="stylesheet" href="../../../../theme/css/pure.css">
    <link rel="stylesheet" href="../../../../theme/css/pygments.css">

    <script src="https://use.fontawesome.com/d373dd2436.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/fitvids/1.0.1/jquery.fitvids.min.js"></script>
    <script>
        $(document).ready(function(){
            $(".content").fitVids();
        });
    </script>

    <!-- Opengraph -->
    <meta property="og:url" content="https://www.quernus.co.uk/2015/10/01/creating-custom-pdf-filter-osx/" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Creating Custom PDF Filter on OS X" />
    <meta property="og:description" content="Sometimes you want to reduce the size of a PDF, say with images embedded. OS X has a built in filter for this, but it is a bit harsh. You can create you own custom ones though." />
    <meta property="og:image" content="https://www.quernus.co.uk/theme/matt_head_bucharest.jpg" />



</head>

<body>
    <div class="pure-g-r" id="layout">
        <div class="sidebar pure-u">
            <div class="cover-img" style="background: none repeat scroll 0% 0% #90a959">
                <div class="cover-body">
                    <header class="header">
                        <hgroup>
<!--                            <h1 class="brand-main"><a href="../../../..">Quernus</a></h1> -->
                            <img class="avatar" src="/theme/matt_head_bucharest.jpg">
                            <p class="tagline">Matt Hamilton. An Internet technologist, interested in Python web development, iOS deployment and testing, wearables, networking and operating systems.</p>
                            <ul class="menu">
                                <li class="links"><a href="/">Home</a></li>
                                <li class="links"><a href="/category/talks.html">Talks</a></li>
                                <li class="links"><a href="/archives.html">Archives</a></li>
                                <li class="links"><a href="../../../../about">About Me / Contact</a></li>
                            </ul>
                                <p class="social">
                                    <a href="https://twitter.com/hammertoe">
                                        <i class="fa fa-twitter fa-3x"></i>
                                    </a>
                                    <a href="https://www.linkedin.com/in/matthamilton77">
                                        <i class="fa fa-linkedin fa-3x"></i>
                                    </a>
                                    <a href="https://www.slideshare.net/hammertoe">
                                        <i class="fa fa-slideshare fa-3x"></i>
                                    </a>
                                    <a href="https://github.com/hammertoe">
                                        <i class="fa fa-github fa-3x"></i>
                                    </a>
                                </p>
                        </hgroup>
                    </header>
                </div>
            </div>
        </div>
    <div class="pure-u">
        <div class="content">
            <section class="post">
                <header class="post-header">
                    <h1>Creating Custom PDF Filter on OS X</h1>
                        <p class="post-meta">
                            // under                                 <a class="post-category" href="../../../../tag/osx.html">osx</a>
                                <a class="post-category" href="../../../../tag/pdf.html">pdf</a>
                        </p>
                </header>
            </section>
            <p>Each month I send an invoice to my clients. Included in that invoice are photos of any receipts for expenses incurred (taxis,etc.). I typically just take a photo of these recipes flat on my desk and then save them as PDFs and drag those PDFs into the main invoice PDF in Preview to create a single file with both the invoice and all the receipts.</p>
<p>This month, I went to send the invoice to the client and Gmail balked at me as the file size was too large. The PDF was 22MB, but I guess once Base64 encoded and S/Mime encrypted it was over the 40MB-ish limit it appears we have on Gmail.</p>
<p>I remember seeing a filter when saving a PDF from preview called 'Reduce File Size'. Sure enough, that reduced the file size down from 22MB to 250KB. But the images of receipts were so heavily compressed that you could not read some of the numbers on them.</p>
<p>Hunting around online I came across <a href="http://hints.macworld.com/article.php?story=20120629091437274">this post from several years ago said you can create your own filters</a>. I check on my Mac running Yosemite (10.10.5) and it still works!</p>
<p>The filters are found in <code>/System/Library/Filters</code> and so I copied the 'Reduce File Size' one and increased the quality and max image resolution as per the post above:</p>
<div class="highlight"><pre><span></span>sudo cp Reduce\ File\ Size.qfilter Reduce\ File\ Size\ Best.qfilter
</pre></div>


<p>My filter contents:</p>
<div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="cp">&lt;!DOCTYPE plist PUBLIC &quot;-//Apple Computer//DTD PLIST 1.0//EN&quot; &quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;&gt;</span>
<span class="nt">&lt;plist</span> <span class="na">version=</span><span class="s">&quot;1.0&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;dict&gt;</span>
    <span class="nt">&lt;key&gt;</span>Domains<span class="nt">&lt;/key&gt;</span>
    <span class="nt">&lt;dict&gt;</span>
        <span class="nt">&lt;key&gt;</span>Applications<span class="nt">&lt;/key&gt;</span>
        <span class="nt">&lt;true/&gt;</span>
        <span class="nt">&lt;key&gt;</span>Printing<span class="nt">&lt;/key&gt;</span>
        <span class="nt">&lt;true/&gt;</span>
    <span class="nt">&lt;/dict&gt;</span>
    <span class="nt">&lt;key&gt;</span>FilterData<span class="nt">&lt;/key&gt;</span>
    <span class="nt">&lt;dict&gt;</span>
        <span class="nt">&lt;key&gt;</span>ColorSettings<span class="nt">&lt;/key&gt;</span>
        <span class="nt">&lt;dict&gt;</span>
            <span class="nt">&lt;key&gt;</span>DocumentColorSettings<span class="nt">&lt;/key&gt;</span>
            <span class="nt">&lt;dict&gt;</span>
                <span class="nt">&lt;key&gt;</span>CustomLHSCorrection<span class="nt">&lt;/key&gt;</span>
                <span class="nt">&lt;array&gt;</span>
                    <span class="nt">&lt;integer&gt;</span>8<span class="nt">&lt;/integer&gt;</span>
                    <span class="nt">&lt;integer&gt;</span>8<span class="nt">&lt;/integer&gt;</span>
                    <span class="nt">&lt;integer&gt;</span>8<span class="nt">&lt;/integer&gt;</span>
                <span class="nt">&lt;/array&gt;</span>
            <span class="nt">&lt;/dict&gt;</span>
            <span class="nt">&lt;key&gt;</span>ImageSettings<span class="nt">&lt;/key&gt;</span>
            <span class="nt">&lt;dict&gt;</span>
                <span class="nt">&lt;key&gt;</span>Compression Quality<span class="nt">&lt;/key&gt;</span>
                <span class="nt">&lt;real&gt;</span>0.75<span class="nt">&lt;/real&gt;</span>
                <span class="nt">&lt;key&gt;</span>ImageCompression<span class="nt">&lt;/key&gt;</span>
                <span class="nt">&lt;string&gt;</span>ImageJPEGCompress<span class="nt">&lt;/string&gt;</span>
                <span class="nt">&lt;key&gt;</span>ImageScaleSettings<span class="nt">&lt;/key&gt;</span>
                <span class="nt">&lt;dict&gt;</span>
                    <span class="nt">&lt;key&gt;</span>ImageScaleFactor<span class="nt">&lt;/key&gt;</span>
                    <span class="nt">&lt;real&gt;</span>0.5<span class="nt">&lt;/real&gt;</span>
                    <span class="nt">&lt;key&gt;</span>ImageScaleInterpolate<span class="nt">&lt;/key&gt;</span>
                    <span class="nt">&lt;true/&gt;</span>
                    <span class="nt">&lt;key&gt;</span>ImageSizeMax<span class="nt">&lt;/key&gt;</span>
                    <span class="nt">&lt;integer&gt;</span>3508<span class="nt">&lt;/integer&gt;</span>
                    <span class="nt">&lt;key&gt;</span>ImageSizeMin<span class="nt">&lt;/key&gt;</span>
                    <span class="nt">&lt;integer&gt;</span>128<span class="nt">&lt;/integer&gt;</span>
                <span class="nt">&lt;/dict&gt;</span>
            <span class="nt">&lt;/dict&gt;</span>
        <span class="nt">&lt;/dict&gt;</span>
    <span class="nt">&lt;/dict&gt;</span>
    <span class="nt">&lt;key&gt;</span>FilterType<span class="nt">&lt;/key&gt;</span>
    <span class="nt">&lt;integer&gt;</span>1<span class="nt">&lt;/integer&gt;</span>
    <span class="nt">&lt;key&gt;</span>Name<span class="nt">&lt;/key&gt;</span>
    <span class="nt">&lt;string&gt;</span>Reduce File Size Best<span class="nt">&lt;/string&gt;</span>
<span class="nt">&lt;/dict&gt;</span>
<span class="nt">&lt;/plist&gt;</span>
</pre></div>


<p>You can then choose this new filter when you select 'export' from within Preview to export the large PDF to a smaller one:</p>
<p><img alt="Screenshot of choose an output filter for PDFs" src="/public/screenshot_reduce_filesize_filter.png" /></p>
<p>This resulted in the PDF dropping from 22.7MB to 1.4MB and the text in the images all still being legible. Result!</p>
            <a href="#" class="go-top">Go Top</a>
<footer class="footer">
    <p>&copy; Matt Hamilton &ndash;
        Built with <a href="https://github.com/PurePelicanTheme/pure-single">Pure Theme</a>
        for <a href="http://blog.getpelican.com/">Pelican</a>
    </p>
</footer>        </div>
    </div>
    </div>
    <script>
        var $top = $('.go-top');

        // Show or hide the sticky footer button
        $(window).scroll(function() {
            if ($(this).scrollTop() > 200) {
                $top.fadeIn(200);
            } else {
                $top.fadeOut(200);
            }
        });

        // Animate the scroll to top
        $top.click(function(event) {
            event.preventDefault();
            $('html, body').animate({scrollTop: 0}, 300);
        })

        // Makes sure that the href="#" attached to the <a> elements
        // don't scroll you back up the page.
        $('body').on('click', 'a[href="#"]', function(event) {
            event.preventDefault();
        });
    </script>
    <script type="text/javascript">
        var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
        document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
        try {
            var pageTracker = _gat._getTracker("UA-65654046-1");
            pageTracker._trackPageview();
            } catch(err) {}
    </script>

</body>
</html>